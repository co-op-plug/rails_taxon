<div class="inline fields">
  <%= f.label "#{outer}_ancestors" %>
  <% if f.object.public_send("#{outer}_id") %>
    <% f.object.public_send("#{outer}").self_and_ancestors.reverse_each do |node| %>
      <%= render partial: 'nodes/outer_options', locals: { f: f, node: node, outer: outer } %>
    <% end %>
  <% else %>
    <%= render partial: 'nodes/outer_options', locals: { f: f, node: outer.classify.constantize.new, outer: outer } %>
  <% end %>
</div>